<template id="aiplugs-breadcrumb">
  <style>
    ul {
      display: flex;
      flex-direction: row;
      margin: 0;
      padding: 0;
      list-style: none;
      line-height: 24px;
      padding: 12px 24px;
      background: var(--color-mono-light);
    }

    li {
      display: inline-block;
      cursor: pointer;
      color: var(--color-secondary-text);
    }

    li:hover {
      color: var(--color-primary);
    }

    li::after {
      content: '/';
      padding: 0 8px;
      color: var(--color-secondary-text);
    }

    li:last-child::after {
      content: '';
    }

    li:first-child::after {
      content: '/';
    }

    li:first-child::before {
      font-family: var(--icon-font-family);
      content: var(--icon-home, 'HOME');
    }
  </style>
  <ul></ul>
</template>
<script>
  (function () {
    const tree = document.currentScript.ownerDocument;
    class Breadcrumb extends HTMLElement {
      constructor() {
        super();
        const template = tree.querySelector('#aiplugs-breadcrumb').content;
        const shadow = this.attachShadow({ mode: 'open' })
        shadow.appendChild(template.cloneNode(true));
        this.el = {
          path: shadow.querySelector('ul')
        };
        this._path = [];
        this._update();
      }
      _update() {
        const template = (['', ...this._path]).map((name, i) => `<li data-index='${i}'>${name}</li>`).join('');
        this.el.path.innerHTML = template;
        this.el.path.querySelectorAll('li').forEach(item => {
          item.addEventListener('click', e => this._onClick(e));
        });
      }
      _onClick(e) {
        const path = this._path.slice(0, e.path[0].dataset.index);
        this.dispatchEvent(new CustomEvent('path.selected', {
          detail: { path }
        }));
      }
      get path() {
        return this._path;
      }
      set path(value) {
        this._path = value;
        this._update();
      }
    }
    window.customElements.define('aiplugs-breadcrumb', Breadcrumb);
  }())
</script>